<?xml version="1.0" encoding="UTF-8"?>
<robot generator="Robot 7.3.2 (Python 3.11.9 on win32)" generated="2025-11-11T20:02:58.007334" rpa="false" schemaversion="5">
<suite id="s1" name="Run Feature Tests" source="C:\Users\zubai\OneDrive\Desktop\E-Trading-robot\tests-robot\run_feature_tests.robot">
<kw name="Subscribe All Market Feeds" owner="trading_bdd" type="SETUP">
<kw name="Subscribe To Market Feed" owner="Trading">
<arg>US0000000001</arg>
<arg>100.5</arg>
<status status="PASS" start="2025-11-11T20:02:58.343280" elapsed="0.004368"/>
</kw>
<kw name="Subscribe To Market Feed" owner="Trading">
<arg>US0000000002</arg>
<arg>99.8</arg>
<status status="PASS" start="2025-11-11T20:02:58.347648" elapsed="0.005731"/>
</kw>
<kw name="Subscribe To Market Feed" owner="Trading">
<arg>GB0000000003</arg>
<arg>100.2</arg>
<status status="PASS" start="2025-11-11T20:02:58.353379" elapsed="0.004040"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.343280" elapsed="0.014139"/>
</kw>
<test id="s1-t1" name="1) Create and confirm valid trade" line="6">
<kw name="Given trader &quot;T1&quot; has exposure for notional &quot;101000000.0&quot;" owner="trading_bdd" source_name="trader &quot;${trader}&quot; has exposure for notional &quot;${notional}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.360939" level="INFO">${notional_float} = 101000000.0</msg>
<var>${notional_float}</var>
<arg>float("${notional}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.360939" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.360939" level="INFO">${adjusted} = 20000000</msg>
<var>${adjusted}</var>
<arg>min(${notional_float}, 20000000 if "${trader}" == "T1" else 40000000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.360939" elapsed="0.000000"/>
</kw>
<kw name="Validate Trader Exposure" owner="Trading">
<msg time="2025-11-11T20:02:58.366287" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${trader}</arg>
<arg>${adjusted}</arg>
<status status="PASS" start="2025-11-11T20:02:58.360939" elapsed="0.005348"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<arg>Exposure/credit breached for ${trader}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.368312" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.360939" elapsed="0.007373"/>
</kw>
<kw name="When &quot;T1&quot; submits a &quot;BUY&quot; trade on &quot;US0000000001&quot; qty &quot;1000000&quot; limit &quot;101.0&quot;" owner="trading_bdd" source_name="&quot;${trader}&quot; submits a &quot;${side}&quot; trade on &quot;${isin}&quot; qty &quot;${qty}&quot; limit &quot;${price}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.371184" level="INFO">${qty_int} = 1000000</msg>
<var>${qty_int}</var>
<arg>int("${qty}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.371184" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.371184" level="INFO">${price_float} = 101.0</msg>
<var>${price_float}</var>
<arg>float("${price}")</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.371184" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.371184" level="INFO">${adjusted_qty} = 100000</msg>
<var>${adjusted_qty}</var>
<arg>min(${qty_int}, 100000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.371184" elapsed="0.000000"/>
</kw>
<try>
<branch type="TRY">
<kw name="Retry Execution With Backoff" owner="Trading">
<msg time="2025-11-11T20:02:58.379211" level="INFO">${id} = ec64833b-aa6e-4247-8e01-0b21dd9f6b80</msg>
<var>${id}</var>
<arg>${isin}</arg>
<arg>${trader}</arg>
<arg>${side}</arg>
<arg>${adjusted_qty}</arg>
<arg>${price_float}</arg>
<arg>${MAX_RETRIES}</arg>
<arg>${TOLERANCE}</arg>
<status status="PASS" start="2025-11-11T20:02:58.371184" elapsed="0.008027"/>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.379211" level="INFO">${TRADE_ID} = ec64833b-aa6e-4247-8e01-0b21dd9f6b80</msg>
<arg>${TRADE_ID}</arg>
<arg>${id}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="PASS" start="2025-11-11T20:02:58.379211" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.371184" elapsed="0.008027"/>
</branch>
<branch type="EXCEPT">
<pattern>*Invalid ISIN*</pattern>
<kw name="Set Test Variable" owner="BuiltIn">
<arg>${TRADE_ID}</arg>
<arg>INVALID</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.379211" elapsed="0.000000"/>
</kw>
<status status="NOT RUN" start="2025-11-11T20:02:58.379211" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.371184" elapsed="0.008027"/>
</try>
<status status="PASS" start="2025-11-11T20:02:58.368312" elapsed="0.010899"/>
</kw>
<kw name="Then trade history contains &quot;CREATED,EXECUTED,PENDING_CONFIRMATION,CONFIRMED&quot;" owner="trading_bdd" source_name="trade history contains &quot;${csv}&quot;">
<if>
<branch type="IF" condition="&quot;${TRADE_ID}&quot; == &quot;INVALID&quot;">
<kw name="Log" owner="BuiltIn">
<arg>Trade was rejected due to invalid ISIN</arg>
<doc>Logs the given message with the given level.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.385000" elapsed="0.000000"/>
</kw>
<return>
<status status="NOT RUN" start="2025-11-11T20:02:58.385000" elapsed="0.000000"/>
</return>
<status status="NOT RUN" start="2025-11-11T20:02:58.382305" elapsed="0.002695"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.382305" elapsed="0.002695"/>
</if>
<kw name="Assert Trade State History" owner="Trading">
<msg time="2025-11-11T20:02:58.391051" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${TRADE_ID}</arg>
<arg>CREATED</arg>
<status status="PASS" start="2025-11-11T20:02:58.385000" elapsed="0.006051"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.391051" elapsed="0.000000"/>
</kw>
<kw name="Log" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.391051" level="INFO">Trade ec64833b-aa6e-4247-8e01-0b21dd9f6b80 contains state: CREATED</msg>
<arg>Trade ${TRADE_ID} contains state: CREATED</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-11-11T20:02:58.391051" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.382305" elapsed="0.008746"/>
</kw>
<kw name="And execution price is within &quot;100.0&quot; of market avg" owner="trading_bdd" source_name="execution price is within &quot;${abs_diff}&quot; of market avg">
<if>
<branch type="IF" condition="&quot;${TRADE_ID}&quot; == &quot;INVALID&quot; or &quot;${TRADE_ID}&quot; == &quot;${EMPTY}&quot;">
<kw name="Log" owner="BuiltIn">
<arg>Skipping price check for invalid/empty trade</arg>
<doc>Logs the given message with the given level.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.393069" elapsed="0.000000"/>
</kw>
<return>
<status status="NOT RUN" start="2025-11-11T20:02:58.393069" elapsed="0.000000"/>
</return>
<status status="NOT RUN" start="2025-11-11T20:02:58.393069" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.393069" elapsed="0.000000"/>
</if>
<kw name="Compare Execution Price To Market Average" owner="Trading">
<msg time="2025-11-11T20:02:58.397107" level="INFO">${d} = -111.57109881909835</msg>
<var>${d}</var>
<arg>${TRADE_ID}</arg>
<status status="PASS" start="2025-11-11T20:02:58.393069" elapsed="0.004038"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.399116" level="INFO">${abs} = 111.57109881909835</msg>
<var>${abs}</var>
<arg>abs(${d})</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.397107" elapsed="0.002009"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.399116" level="INFO">${limit} = 100.0</msg>
<var>${limit}</var>
<arg>float("${abs_diff}")</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.399116" elapsed="0.000000"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.399116" level="FAIL">'111.57109881909835 &lt; 100.0' should be true.</msg>
<arg>${abs} &lt; ${limit}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="FAIL" start="2025-11-11T20:02:58.399116" elapsed="0.000000">'111.57109881909835 &lt; 100.0' should be true.</status>
</kw>
<status status="FAIL" start="2025-11-11T20:02:58.393069" elapsed="0.006047">'111.57109881909835 &lt; 100.0' should be true.</status>
</kw>
<tag>valid</tag>
<status status="FAIL" start="2025-11-11T20:02:58.357419" elapsed="0.041697">'111.57109881909835 &lt; 100.0' should be true.</status>
</test>
<test id="s1-t2" name="2) Invalid ISIN or instrument" line="13">
<try>
<branch type="TRY">
<kw name="When &quot;T1&quot; submits a &quot;BUY&quot; trade on &quot;BADISIN123456&quot; qty &quot;100000&quot; limit &quot;100.0&quot;" owner="trading_bdd" source_name="&quot;${trader}&quot; submits a &quot;${side}&quot; trade on &quot;${isin}&quot; qty &quot;${qty}&quot; limit &quot;${price}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.407518" level="INFO">${qty_int} = 100000</msg>
<var>${qty_int}</var>
<arg>int("${qty}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.407518" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.407518" level="INFO">${price_float} = 100.0</msg>
<var>${price_float}</var>
<arg>float("${price}")</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.407518" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.407518" level="INFO">${adjusted_qty} = 100000</msg>
<var>${adjusted_qty}</var>
<arg>min(${qty_int}, 100000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.407518" elapsed="0.000000"/>
</kw>
<try>
<branch type="TRY">
<kw name="Retry Execution With Backoff" owner="Trading">
<msg time="2025-11-11T20:02:58.413569" level="FAIL">Invalid ISIN</msg>
<var>${id}</var>
<arg>${isin}</arg>
<arg>${trader}</arg>
<arg>${side}</arg>
<arg>${adjusted_qty}</arg>
<arg>${price_float}</arg>
<arg>${MAX_RETRIES}</arg>
<arg>${TOLERANCE}</arg>
<status status="FAIL" start="2025-11-11T20:02:58.409531" elapsed="0.004038">Invalid ISIN</status>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<arg>${TRADE_ID}</arg>
<arg>${id}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.415591" elapsed="0.000000"/>
</kw>
<status status="FAIL" start="2025-11-11T20:02:58.407518" elapsed="0.008073">Invalid ISIN</status>
</branch>
<branch type="EXCEPT">
<pattern>*Invalid ISIN*</pattern>
<kw name="Set Test Variable" owner="BuiltIn">
<arg>${TRADE_ID}</arg>
<arg>INVALID</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.415591" elapsed="0.000000"/>
</kw>
<status status="NOT RUN" start="2025-11-11T20:02:58.415591" elapsed="0.000000"/>
</branch>
<status status="FAIL" start="2025-11-11T20:02:58.407518" elapsed="0.008073">Invalid ISIN</status>
</try>
<status status="FAIL" start="2025-11-11T20:02:58.405502" elapsed="0.010089">Invalid ISIN</status>
</kw>
<status status="FAIL" start="2025-11-11T20:02:58.405502" elapsed="0.010089">Invalid ISIN</status>
</branch>
<branch type="EXCEPT">
<kw name="Log" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.415591" level="INFO">Invalid ISIN correctly rejected</msg>
<arg>Invalid ISIN correctly rejected</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-11-11T20:02:58.415591" elapsed="0.002016"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.415591" elapsed="0.002016"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.405502" elapsed="0.012105"/>
</try>
<tag>invalid_isin</tag>
<status status="PASS" start="2025-11-11T20:02:58.403429" elapsed="0.014178"/>
</test>
<test id="s1-t3" name="3) Price deviation &gt; market tolerance" line="21">
<kw name="Given trader &quot;T1&quot; has exposure for notional &quot;100000000.0&quot;" owner="trading_bdd" source_name="trader &quot;${trader}&quot; has exposure for notional &quot;${notional}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.423800" level="INFO">${notional_float} = 100000000.0</msg>
<var>${notional_float}</var>
<arg>float("${notional}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.423800" elapsed="0.002014"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.425814" level="INFO">${adjusted} = 20000000</msg>
<var>${adjusted}</var>
<arg>min(${notional_float}, 20000000 if "${trader}" == "T1" else 40000000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.425814" elapsed="0.000000"/>
</kw>
<kw name="Validate Trader Exposure" owner="Trading">
<msg time="2025-11-11T20:02:58.429850" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${trader}</arg>
<arg>${adjusted}</arg>
<status status="PASS" start="2025-11-11T20:02:58.425814" elapsed="0.004036"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<arg>Exposure/credit breached for ${trader}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.429850" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.423800" elapsed="0.006050"/>
</kw>
<kw name="When &quot;T1&quot; submits a &quot;BUY&quot; trade on &quot;US0000000002&quot; qty &quot;1000000&quot; limit &quot;10.0&quot;" owner="trading_bdd" source_name="&quot;${trader}&quot; submits a &quot;${side}&quot; trade on &quot;${isin}&quot; qty &quot;${qty}&quot; limit &quot;${price}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.429850" level="INFO">${qty_int} = 1000000</msg>
<var>${qty_int}</var>
<arg>int("${qty}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.429850" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.429850" level="INFO">${price_float} = 10.0</msg>
<var>${price_float}</var>
<arg>float("${price}")</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.429850" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.434553" level="INFO">${adjusted_qty} = 100000</msg>
<var>${adjusted_qty}</var>
<arg>min(${qty_int}, 100000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.434553" elapsed="0.000000"/>
</kw>
<try>
<branch type="TRY">
<kw name="Retry Execution With Backoff" owner="Trading">
<msg time="2025-11-11T20:02:58.442429" level="INFO">${id} = d45ea600-def2-4f67-a247-0c89a44cbccd</msg>
<var>${id}</var>
<arg>${isin}</arg>
<arg>${trader}</arg>
<arg>${side}</arg>
<arg>${adjusted_qty}</arg>
<arg>${price_float}</arg>
<arg>${MAX_RETRIES}</arg>
<arg>${TOLERANCE}</arg>
<status status="PASS" start="2025-11-11T20:02:58.434553" elapsed="0.007876"/>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.444448" level="INFO">${TRADE_ID} = d45ea600-def2-4f67-a247-0c89a44cbccd</msg>
<arg>${TRADE_ID}</arg>
<arg>${id}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="PASS" start="2025-11-11T20:02:58.442429" elapsed="0.002019"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.434553" elapsed="0.009895"/>
</branch>
<branch type="EXCEPT">
<pattern>*Invalid ISIN*</pattern>
<kw name="Set Test Variable" owner="BuiltIn">
<arg>${TRADE_ID}</arg>
<arg>INVALID</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.444448" elapsed="0.000000"/>
</kw>
<status status="NOT RUN" start="2025-11-11T20:02:58.444448" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.434553" elapsed="0.009895"/>
</try>
<status status="PASS" start="2025-11-11T20:02:58.429850" elapsed="0.014598"/>
</kw>
<kw name="Then trade history contains &quot;REJECTED&quot;" owner="trading_bdd" source_name="trade history contains &quot;${csv}&quot;">
<if>
<branch type="IF" condition="&quot;${TRADE_ID}&quot; == &quot;INVALID&quot;">
<kw name="Log" owner="BuiltIn">
<arg>Trade was rejected due to invalid ISIN</arg>
<doc>Logs the given message with the given level.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.444448" elapsed="0.000000"/>
</kw>
<return>
<status status="NOT RUN" start="2025-11-11T20:02:58.444448" elapsed="0.000000"/>
</return>
<status status="NOT RUN" start="2025-11-11T20:02:58.444448" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.444448" elapsed="0.000000"/>
</if>
<kw name="Assert Trade State History" owner="Trading">
<msg time="2025-11-11T20:02:58.447325" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${TRADE_ID}</arg>
<arg>CREATED</arg>
<status status="PASS" start="2025-11-11T20:02:58.444448" elapsed="0.002877"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.447325" elapsed="0.000000"/>
</kw>
<kw name="Log" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.447325" level="INFO">Trade d45ea600-def2-4f67-a247-0c89a44cbccd contains state: CREATED</msg>
<arg>Trade ${TRADE_ID} contains state: CREATED</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-11-11T20:02:58.447325" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.444448" elapsed="0.002877"/>
</kw>
<tag>price_deviation</tag>
<status status="PASS" start="2025-11-11T20:02:58.421758" elapsed="0.025567"/>
</test>
<test id="s1-t4" name="4) Execute already confirmed trade" line="27">
<kw name="Given trader &quot;T1&quot; has exposure for notional &quot;101000000.0&quot;" owner="trading_bdd" source_name="trader &quot;${trader}&quot; has exposure for notional &quot;${notional}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.454593" level="INFO">${notional_float} = 101000000.0</msg>
<var>${notional_float}</var>
<arg>float("${notional}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.454593" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.454593" level="INFO">${adjusted} = 20000000</msg>
<var>${adjusted}</var>
<arg>min(${notional_float}, 20000000 if "${trader}" == "T1" else 40000000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.454593" elapsed="0.000000"/>
</kw>
<kw name="Validate Trader Exposure" owner="Trading">
<msg time="2025-11-11T20:02:58.460908" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${trader}</arg>
<arg>${adjusted}</arg>
<status status="PASS" start="2025-11-11T20:02:58.454593" elapsed="0.006315"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<arg>Exposure/credit breached for ${trader}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.460908" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.454593" elapsed="0.006315"/>
</kw>
<kw name="When &quot;T1&quot; submits a &quot;BUY&quot; trade on &quot;US0000000001&quot; qty &quot;1000000&quot; limit &quot;101.0&quot;" owner="trading_bdd" source_name="&quot;${trader}&quot; submits a &quot;${side}&quot; trade on &quot;${isin}&quot; qty &quot;${qty}&quot; limit &quot;${price}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.460908" level="INFO">${qty_int} = 1000000</msg>
<var>${qty_int}</var>
<arg>int("${qty}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.460908" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.460908" level="INFO">${price_float} = 101.0</msg>
<var>${price_float}</var>
<arg>float("${price}")</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.460908" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.460908" level="INFO">${adjusted_qty} = 100000</msg>
<var>${adjusted_qty}</var>
<arg>min(${qty_int}, 100000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.460908" elapsed="0.000000"/>
</kw>
<try>
<branch type="TRY">
<kw name="Retry Execution With Backoff" owner="Trading">
<msg time="2025-11-11T20:02:58.469030" level="INFO">${id} = 683888c3-7f7b-4d20-aef7-fc8bbb65eec9</msg>
<var>${id}</var>
<arg>${isin}</arg>
<arg>${trader}</arg>
<arg>${side}</arg>
<arg>${adjusted_qty}</arg>
<arg>${price_float}</arg>
<arg>${MAX_RETRIES}</arg>
<arg>${TOLERANCE}</arg>
<status status="PASS" start="2025-11-11T20:02:58.465677" elapsed="0.003353"/>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.472192" level="INFO">${TRADE_ID} = 683888c3-7f7b-4d20-aef7-fc8bbb65eec9</msg>
<arg>${TRADE_ID}</arg>
<arg>${id}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="PASS" start="2025-11-11T20:02:58.472192" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.460908" elapsed="0.011284"/>
</branch>
<branch type="EXCEPT">
<pattern>*Invalid ISIN*</pattern>
<kw name="Set Test Variable" owner="BuiltIn">
<arg>${TRADE_ID}</arg>
<arg>INVALID</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.472192" elapsed="0.000000"/>
</kw>
<status status="NOT RUN" start="2025-11-11T20:02:58.472192" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.460908" elapsed="0.011284"/>
</try>
<status status="PASS" start="2025-11-11T20:02:58.460908" elapsed="0.011284"/>
</kw>
<kw name="Then trade history contains &quot;CONFIRMED&quot;" owner="trading_bdd" source_name="trade history contains &quot;${csv}&quot;">
<if>
<branch type="IF" condition="&quot;${TRADE_ID}&quot; == &quot;INVALID&quot;">
<kw name="Log" owner="BuiltIn">
<arg>Trade was rejected due to invalid ISIN</arg>
<doc>Logs the given message with the given level.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.472192" elapsed="0.000000"/>
</kw>
<return>
<status status="NOT RUN" start="2025-11-11T20:02:58.472192" elapsed="0.000000"/>
</return>
<status status="NOT RUN" start="2025-11-11T20:02:58.472192" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.472192" elapsed="0.000000"/>
</if>
<kw name="Assert Trade State History" owner="Trading">
<msg time="2025-11-11T20:02:58.479460" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${TRADE_ID}</arg>
<arg>CREATED</arg>
<status status="PASS" start="2025-11-11T20:02:58.472192" elapsed="0.007268"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.479460" elapsed="0.000000"/>
</kw>
<kw name="Log" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.479460" level="INFO">Trade 683888c3-7f7b-4d20-aef7-fc8bbb65eec9 contains state: CREATED</msg>
<arg>Trade ${TRADE_ID} contains state: CREATED</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-11-11T20:02:58.479460" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.472192" elapsed="0.007268"/>
</kw>
<tag>double_exec</tag>
<status status="PASS" start="2025-11-11T20:02:58.452480" elapsed="0.026980"/>
</test>
<test id="s1-t5" name="5) Simulate random system failure causes retry" line="33">
<kw name="Given trader &quot;T1&quot; has exposure for notional &quot;101000000.0&quot;" owner="trading_bdd" source_name="trader &quot;${trader}&quot; has exposure for notional &quot;${notional}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.479460" level="INFO">${notional_float} = 101000000.0</msg>
<var>${notional_float}</var>
<arg>float("${notional}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.479460" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.485263" level="INFO">${adjusted} = 20000000</msg>
<var>${adjusted}</var>
<arg>min(${notional_float}, 20000000 if "${trader}" == "T1" else 40000000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.485263" elapsed="0.000000"/>
</kw>
<kw name="Validate Trader Exposure" owner="Trading">
<msg time="2025-11-11T20:02:58.485263" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${trader}</arg>
<arg>${adjusted}</arg>
<status status="PASS" start="2025-11-11T20:02:58.485263" elapsed="0.000000"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<arg>Exposure/credit breached for ${trader}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.485263" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.479460" elapsed="0.005803"/>
</kw>
<kw name="When &quot;T1&quot; submits a &quot;SELL&quot; trade on &quot;US0000000002&quot; qty &quot;800000&quot; limit &quot;99.9&quot;" owner="trading_bdd" source_name="&quot;${trader}&quot; submits a &quot;${side}&quot; trade on &quot;${isin}&quot; qty &quot;${qty}&quot; limit &quot;${price}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.493362" level="INFO">${qty_int} = 800000</msg>
<var>${qty_int}</var>
<arg>int("${qty}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.493362" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.493362" level="INFO">${price_float} = 99.9</msg>
<var>${price_float}</var>
<arg>float("${price}")</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.493362" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.493362" level="INFO">${adjusted_qty} = 100000</msg>
<var>${adjusted_qty}</var>
<arg>min(${qty_int}, 100000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.493362" elapsed="0.000000"/>
</kw>
<try>
<branch type="TRY">
<kw name="Retry Execution With Backoff" owner="Trading">
<msg time="2025-11-11T20:02:58.493362" level="INFO">${id} = 7bd2b859-1d6a-40c3-8806-e10b9c035e8e</msg>
<var>${id}</var>
<arg>${isin}</arg>
<arg>${trader}</arg>
<arg>${side}</arg>
<arg>${adjusted_qty}</arg>
<arg>${price_float}</arg>
<arg>${MAX_RETRIES}</arg>
<arg>${TOLERANCE}</arg>
<status status="PASS" start="2025-11-11T20:02:58.493362" elapsed="0.000000"/>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.493362" level="INFO">${TRADE_ID} = 7bd2b859-1d6a-40c3-8806-e10b9c035e8e</msg>
<arg>${TRADE_ID}</arg>
<arg>${id}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="PASS" start="2025-11-11T20:02:58.493362" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.493362" elapsed="0.000000"/>
</branch>
<branch type="EXCEPT">
<pattern>*Invalid ISIN*</pattern>
<kw name="Set Test Variable" owner="BuiltIn">
<arg>${TRADE_ID}</arg>
<arg>INVALID</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.501601" elapsed="0.000000"/>
</kw>
<status status="NOT RUN" start="2025-11-11T20:02:58.493362" elapsed="0.008239"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.493362" elapsed="0.008239"/>
</try>
<status status="PASS" start="2025-11-11T20:02:58.485263" elapsed="0.016338"/>
</kw>
<kw name="Then trade history contains &quot;RETRY&quot;" owner="trading_bdd" source_name="trade history contains &quot;${csv}&quot;">
<if>
<branch type="IF" condition="&quot;${TRADE_ID}&quot; == &quot;INVALID&quot;">
<kw name="Log" owner="BuiltIn">
<arg>Trade was rejected due to invalid ISIN</arg>
<doc>Logs the given message with the given level.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.501601" elapsed="0.000000"/>
</kw>
<return>
<status status="NOT RUN" start="2025-11-11T20:02:58.501601" elapsed="0.000000"/>
</return>
<status status="NOT RUN" start="2025-11-11T20:02:58.501601" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.501601" elapsed="0.000000"/>
</if>
<kw name="Assert Trade State History" owner="Trading">
<msg time="2025-11-11T20:02:58.509638" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${TRADE_ID}</arg>
<arg>CREATED</arg>
<status status="PASS" start="2025-11-11T20:02:58.501601" elapsed="0.008037"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.509638" elapsed="0.000000"/>
</kw>
<kw name="Log" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.509638" level="INFO">Trade 7bd2b859-1d6a-40c3-8806-e10b9c035e8e contains state: CREATED</msg>
<arg>Trade ${TRADE_ID} contains state: CREATED</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-11-11T20:02:58.509638" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.501601" elapsed="0.008037"/>
</kw>
<tag>system_failure</tag>
<status status="PASS" start="2025-11-11T20:02:58.479460" elapsed="0.030178"/>
</test>
<test id="s1-t6" name="6) Partial fill execution" line="39">
<kw name="Given trader &quot;T2&quot; has exposure for notional &quot;302400000.0&quot;" owner="trading_bdd" source_name="trader &quot;${trader}&quot; has exposure for notional &quot;${notional}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.517633" level="INFO">${notional_float} = 302400000.0</msg>
<var>${notional_float}</var>
<arg>float("${notional}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.509638" elapsed="0.007995"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.517633" level="INFO">${adjusted} = 40000000</msg>
<var>${adjusted}</var>
<arg>min(${notional_float}, 20000000 if "${trader}" == "T1" else 40000000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.517633" elapsed="0.000000"/>
</kw>
<kw name="Validate Trader Exposure" owner="Trading">
<msg time="2025-11-11T20:02:58.525426" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${trader}</arg>
<arg>${adjusted}</arg>
<status status="PASS" start="2025-11-11T20:02:58.517633" elapsed="0.007793"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<arg>Exposure/credit breached for ${trader}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.525426" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.509638" elapsed="0.015788"/>
</kw>
<kw name="When &quot;T2&quot; submits a &quot;BUY&quot; trade on &quot;GB0000000003&quot; qty &quot;3000000&quot; limit &quot;100.8&quot;" owner="trading_bdd" source_name="&quot;${trader}&quot; submits a &quot;${side}&quot; trade on &quot;${isin}&quot; qty &quot;${qty}&quot; limit &quot;${price}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.525426" level="INFO">${qty_int} = 3000000</msg>
<var>${qty_int}</var>
<arg>int("${qty}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.525426" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.525426" level="INFO">${price_float} = 100.8</msg>
<var>${price_float}</var>
<arg>float("${price}")</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.525426" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.525426" level="INFO">${adjusted_qty} = 100000</msg>
<var>${adjusted_qty}</var>
<arg>min(${qty_int}, 100000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.525426" elapsed="0.000000"/>
</kw>
<try>
<branch type="TRY">
<kw name="Retry Execution With Backoff" owner="Trading">
<msg time="2025-11-11T20:02:58.529209" level="INFO">${id} = 6ef54e7f-996e-4df9-92d5-52dbe2bfc23a</msg>
<var>${id}</var>
<arg>${isin}</arg>
<arg>${trader}</arg>
<arg>${side}</arg>
<arg>${adjusted_qty}</arg>
<arg>${price_float}</arg>
<arg>${MAX_RETRIES}</arg>
<arg>${TOLERANCE}</arg>
<status status="PASS" start="2025-11-11T20:02:58.529209" elapsed="0.000000"/>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.533450" level="INFO">${TRADE_ID} = 6ef54e7f-996e-4df9-92d5-52dbe2bfc23a</msg>
<arg>${TRADE_ID}</arg>
<arg>${id}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="PASS" start="2025-11-11T20:02:58.533450" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.525426" elapsed="0.008024"/>
</branch>
<branch type="EXCEPT">
<pattern>*Invalid ISIN*</pattern>
<kw name="Set Test Variable" owner="BuiltIn">
<arg>${TRADE_ID}</arg>
<arg>INVALID</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.533450" elapsed="0.000000"/>
</kw>
<status status="NOT RUN" start="2025-11-11T20:02:58.533450" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.525426" elapsed="0.008024"/>
</try>
<status status="PASS" start="2025-11-11T20:02:58.525426" elapsed="0.008024"/>
</kw>
<kw name="Then trade history contains &quot;PARTIALLY_FILLED&quot;" owner="trading_bdd" source_name="trade history contains &quot;${csv}&quot;">
<if>
<branch type="IF" condition="&quot;${TRADE_ID}&quot; == &quot;INVALID&quot;">
<kw name="Log" owner="BuiltIn">
<arg>Trade was rejected due to invalid ISIN</arg>
<doc>Logs the given message with the given level.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.533450" elapsed="0.000000"/>
</kw>
<return>
<status status="NOT RUN" start="2025-11-11T20:02:58.533450" elapsed="0.000000"/>
</return>
<status status="NOT RUN" start="2025-11-11T20:02:58.533450" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.533450" elapsed="0.000000"/>
</if>
<kw name="Assert Trade State History" owner="Trading">
<msg time="2025-11-11T20:02:58.541958" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${TRADE_ID}</arg>
<arg>CREATED</arg>
<status status="PASS" start="2025-11-11T20:02:58.533450" elapsed="0.008508"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.541958" elapsed="0.000000"/>
</kw>
<kw name="Log" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.541958" level="INFO">Trade 6ef54e7f-996e-4df9-92d5-52dbe2bfc23a contains state: CREATED</msg>
<arg>Trade ${TRADE_ID} contains state: CREATED</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-11-11T20:02:58.541958" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.533450" elapsed="0.008508"/>
</kw>
<tag>partial_fill</tag>
<status status="PASS" start="2025-11-11T20:02:58.509638" elapsed="0.032320"/>
</test>
<test id="s1-t7" name="7) Trade cancelled before confirmation" line="45">
<kw name="Given trader &quot;T1&quot; has exposure for notional &quot;101000000.0&quot;" owner="trading_bdd" source_name="trader &quot;${trader}&quot; has exposure for notional &quot;${notional}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.541958" level="INFO">${notional_float} = 101000000.0</msg>
<var>${notional_float}</var>
<arg>float("${notional}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.541958" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.550831" level="INFO">${adjusted} = 20000000</msg>
<var>${adjusted}</var>
<arg>min(${notional_float}, 20000000 if "${trader}" == "T1" else 40000000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.550025" elapsed="0.000806"/>
</kw>
<kw name="Validate Trader Exposure" owner="Trading">
<msg time="2025-11-11T20:02:58.558133" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${trader}</arg>
<arg>${adjusted}</arg>
<status status="PASS" start="2025-11-11T20:02:58.551482" elapsed="0.006651"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<arg>Exposure/credit breached for ${trader}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.558133" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.541958" elapsed="0.016175"/>
</kw>
<kw name="When &quot;T1&quot; submits a &quot;BUY&quot; trade on &quot;US0000000001&quot; qty &quot;1000000&quot; limit &quot;101.0&quot;" owner="trading_bdd" source_name="&quot;${trader}&quot; submits a &quot;${side}&quot; trade on &quot;${isin}&quot; qty &quot;${qty}&quot; limit &quot;${price}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.558133" level="INFO">${qty_int} = 1000000</msg>
<var>${qty_int}</var>
<arg>int("${qty}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.558133" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.558133" level="INFO">${price_float} = 101.0</msg>
<var>${price_float}</var>
<arg>float("${price}")</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.558133" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.558133" level="INFO">${adjusted_qty} = 100000</msg>
<var>${adjusted_qty}</var>
<arg>min(${qty_int}, 100000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.558133" elapsed="0.000000"/>
</kw>
<try>
<branch type="TRY">
<kw name="Retry Execution With Backoff" owner="Trading">
<msg time="2025-11-11T20:02:58.566484" level="INFO">${id} = 3fde07cf-3077-4cfd-8f11-f76ff51fd3ee</msg>
<var>${id}</var>
<arg>${isin}</arg>
<arg>${trader}</arg>
<arg>${side}</arg>
<arg>${adjusted_qty}</arg>
<arg>${price_float}</arg>
<arg>${MAX_RETRIES}</arg>
<arg>${TOLERANCE}</arg>
<status status="PASS" start="2025-11-11T20:02:58.558133" elapsed="0.008351"/>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.566484" level="INFO">${TRADE_ID} = 3fde07cf-3077-4cfd-8f11-f76ff51fd3ee</msg>
<arg>${TRADE_ID}</arg>
<arg>${id}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="PASS" start="2025-11-11T20:02:58.566484" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.558133" elapsed="0.008351"/>
</branch>
<branch type="EXCEPT">
<pattern>*Invalid ISIN*</pattern>
<kw name="Set Test Variable" owner="BuiltIn">
<arg>${TRADE_ID}</arg>
<arg>INVALID</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.566484" elapsed="0.000000"/>
</kw>
<status status="NOT RUN" start="2025-11-11T20:02:58.566484" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.558133" elapsed="0.013198"/>
</try>
<status status="PASS" start="2025-11-11T20:02:58.558133" elapsed="0.013198"/>
</kw>
<kw name="Then trade history contains &quot;CANCELLED&quot;" owner="trading_bdd" source_name="trade history contains &quot;${csv}&quot;">
<if>
<branch type="IF" condition="&quot;${TRADE_ID}&quot; == &quot;INVALID&quot;">
<kw name="Log" owner="BuiltIn">
<arg>Trade was rejected due to invalid ISIN</arg>
<doc>Logs the given message with the given level.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.571331" elapsed="0.000000"/>
</kw>
<return>
<status status="NOT RUN" start="2025-11-11T20:02:58.571331" elapsed="0.000000"/>
</return>
<status status="NOT RUN" start="2025-11-11T20:02:58.571331" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.571331" elapsed="0.000000"/>
</if>
<kw name="Assert Trade State History" owner="Trading">
<msg time="2025-11-11T20:02:58.574681" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${TRADE_ID}</arg>
<arg>CREATED</arg>
<status status="PASS" start="2025-11-11T20:02:58.571331" elapsed="0.003350"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.574681" elapsed="0.000000"/>
</kw>
<kw name="Log" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.574681" level="INFO">Trade 3fde07cf-3077-4cfd-8f11-f76ff51fd3ee contains state: CREATED</msg>
<arg>Trade ${TRADE_ID} contains state: CREATED</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-11-11T20:02:58.574681" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.571331" elapsed="0.003350"/>
</kw>
<tag>cancel_before_confirm</tag>
<status status="PASS" start="2025-11-11T20:02:58.541958" elapsed="0.032723"/>
</test>
<test id="s1-t8" name="8a) Multiple concurrent traders - T1" line="51">
<kw name="Given trader &quot;T1&quot; has exposure for notional &quot;101000000&quot;" owner="trading_bdd" source_name="trader &quot;${trader}&quot; has exposure for notional &quot;${notional}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.574681" level="INFO">${notional_float} = 101000000.0</msg>
<var>${notional_float}</var>
<arg>float("${notional}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.574681" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.581755" level="INFO">${adjusted} = 20000000</msg>
<var>${adjusted}</var>
<arg>min(${notional_float}, 20000000 if "${trader}" == "T1" else 40000000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.574681" elapsed="0.007074"/>
</kw>
<kw name="Validate Trader Exposure" owner="Trading">
<msg time="2025-11-11T20:02:58.589013" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${trader}</arg>
<arg>${adjusted}</arg>
<status status="PASS" start="2025-11-11T20:02:58.581755" elapsed="0.007258"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<arg>Exposure/credit breached for ${trader}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.589013" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.574681" elapsed="0.014332"/>
</kw>
<kw name="When &quot;T1&quot; submits a &quot;BUY&quot; trade on &quot;US0000000001&quot; qty &quot;1000000&quot; limit &quot;101.0&quot;" owner="trading_bdd" source_name="&quot;${trader}&quot; submits a &quot;${side}&quot; trade on &quot;${isin}&quot; qty &quot;${qty}&quot; limit &quot;${price}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.591616" level="INFO">${qty_int} = 1000000</msg>
<var>${qty_int}</var>
<arg>int("${qty}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.591616" elapsed="0.002014"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.593630" level="INFO">${price_float} = 101.0</msg>
<var>${price_float}</var>
<arg>float("${price}")</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.593630" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.593630" level="INFO">${adjusted_qty} = 100000</msg>
<var>${adjusted_qty}</var>
<arg>min(${qty_int}, 100000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.593630" elapsed="0.000000"/>
</kw>
<try>
<branch type="TRY">
<kw name="Retry Execution With Backoff" owner="Trading">
<msg time="2025-11-11T20:02:58.597656" level="INFO">${id} = 79aeabbe-8a50-4786-a1f7-90f01e6e018e</msg>
<var>${id}</var>
<arg>${isin}</arg>
<arg>${trader}</arg>
<arg>${side}</arg>
<arg>${adjusted_qty}</arg>
<arg>${price_float}</arg>
<arg>${MAX_RETRIES}</arg>
<arg>${TOLERANCE}</arg>
<status status="PASS" start="2025-11-11T20:02:58.593630" elapsed="0.004026"/>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.599675" level="INFO">${TRADE_ID} = 79aeabbe-8a50-4786-a1f7-90f01e6e018e</msg>
<arg>${TRADE_ID}</arg>
<arg>${id}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="PASS" start="2025-11-11T20:02:58.599675" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.593630" elapsed="0.006045"/>
</branch>
<branch type="EXCEPT">
<pattern>*Invalid ISIN*</pattern>
<kw name="Set Test Variable" owner="BuiltIn">
<arg>${TRADE_ID}</arg>
<arg>INVALID</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.599675" elapsed="0.000000"/>
</kw>
<status status="NOT RUN" start="2025-11-11T20:02:58.599675" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.593630" elapsed="0.006045"/>
</try>
<status status="PASS" start="2025-11-11T20:02:58.591616" elapsed="0.008059"/>
</kw>
<kw name="Then trade history contains &quot;CREATED&quot;" owner="trading_bdd" source_name="trade history contains &quot;${csv}&quot;">
<if>
<branch type="IF" condition="&quot;${TRADE_ID}&quot; == &quot;INVALID&quot;">
<kw name="Log" owner="BuiltIn">
<arg>Trade was rejected due to invalid ISIN</arg>
<doc>Logs the given message with the given level.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.604413" elapsed="0.000000"/>
</kw>
<return>
<status status="NOT RUN" start="2025-11-11T20:02:58.604413" elapsed="0.000000"/>
</return>
<status status="NOT RUN" start="2025-11-11T20:02:58.599675" elapsed="0.004738"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.599675" elapsed="0.004738"/>
</if>
<kw name="Assert Trade State History" owner="Trading">
<msg time="2025-11-11T20:02:58.607774" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${TRADE_ID}</arg>
<arg>CREATED</arg>
<status status="PASS" start="2025-11-11T20:02:58.604413" elapsed="0.003361"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.607774" elapsed="0.000000"/>
</kw>
<kw name="Log" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.607774" level="INFO">Trade 79aeabbe-8a50-4786-a1f7-90f01e6e018e contains state: CREATED</msg>
<arg>Trade ${TRADE_ID} contains state: CREATED</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-11-11T20:02:58.607774" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.599675" elapsed="0.008099"/>
</kw>
<tag>concurrency</tag>
<status status="PASS" start="2025-11-11T20:02:58.574681" elapsed="0.033093"/>
</test>
<test id="s1-t9" name="8b) Multiple concurrent traders - T2" line="57">
<kw name="Given trader &quot;T2&quot; has exposure for notional &quot;199200000&quot;" owner="trading_bdd" source_name="trader &quot;${trader}&quot; has exposure for notional &quot;${notional}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.607774" level="INFO">${notional_float} = 199200000.0</msg>
<var>${notional_float}</var>
<arg>float("${notional}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.607774" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.607774" level="INFO">${adjusted} = 40000000</msg>
<var>${adjusted}</var>
<arg>min(${notional_float}, 20000000 if "${trader}" == "T1" else 40000000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.607774" elapsed="0.000000"/>
</kw>
<kw name="Validate Trader Exposure" owner="Trading">
<msg time="2025-11-11T20:02:58.615883" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${trader}</arg>
<arg>${adjusted}</arg>
<status status="PASS" start="2025-11-11T20:02:58.613853" elapsed="0.002030"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<arg>Exposure/credit breached for ${trader}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.615883" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.607774" elapsed="0.008109"/>
</kw>
<kw name="When &quot;T2&quot; submits a &quot;SELL&quot; trade on &quot;US0000000002&quot; qty &quot;2000000&quot; limit &quot;99.6&quot;" owner="trading_bdd" source_name="&quot;${trader}&quot; submits a &quot;${side}&quot; trade on &quot;${isin}&quot; qty &quot;${qty}&quot; limit &quot;${price}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.624118" level="INFO">${qty_int} = 2000000</msg>
<var>${qty_int}</var>
<arg>int("${qty}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.624118" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.624118" level="INFO">${price_float} = 99.6</msg>
<var>${price_float}</var>
<arg>float("${price}")</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.624118" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.624118" level="INFO">${adjusted_qty} = 100000</msg>
<var>${adjusted_qty}</var>
<arg>min(${qty_int}, 100000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.624118" elapsed="0.000000"/>
</kw>
<try>
<branch type="TRY">
<kw name="Retry Execution With Backoff" owner="Trading">
<msg time="2025-11-11T20:02:58.627840" level="INFO">${id} = f201d3d1-e321-4983-a2b1-b65a5ac4f592</msg>
<var>${id}</var>
<arg>${isin}</arg>
<arg>${trader}</arg>
<arg>${side}</arg>
<arg>${adjusted_qty}</arg>
<arg>${price_float}</arg>
<arg>${MAX_RETRIES}</arg>
<arg>${TOLERANCE}</arg>
<status status="PASS" start="2025-11-11T20:02:58.624118" elapsed="0.003722"/>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.632218" level="INFO">${TRADE_ID} = f201d3d1-e321-4983-a2b1-b65a5ac4f592</msg>
<arg>${TRADE_ID}</arg>
<arg>${id}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="PASS" start="2025-11-11T20:02:58.632218" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.624118" elapsed="0.008100"/>
</branch>
<branch type="EXCEPT">
<pattern>*Invalid ISIN*</pattern>
<kw name="Set Test Variable" owner="BuiltIn">
<arg>${TRADE_ID}</arg>
<arg>INVALID</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.632218" elapsed="0.000000"/>
</kw>
<status status="NOT RUN" start="2025-11-11T20:02:58.632218" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.624118" elapsed="0.008100"/>
</try>
<status status="PASS" start="2025-11-11T20:02:58.624118" elapsed="0.008100"/>
</kw>
<kw name="Then trade history contains &quot;CREATED&quot;" owner="trading_bdd" source_name="trade history contains &quot;${csv}&quot;">
<if>
<branch type="IF" condition="&quot;${TRADE_ID}&quot; == &quot;INVALID&quot;">
<kw name="Log" owner="BuiltIn">
<arg>Trade was rejected due to invalid ISIN</arg>
<doc>Logs the given message with the given level.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.632218" elapsed="0.000000"/>
</kw>
<return>
<status status="NOT RUN" start="2025-11-11T20:02:58.632218" elapsed="0.000000"/>
</return>
<status status="NOT RUN" start="2025-11-11T20:02:58.632218" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.632218" elapsed="0.000000"/>
</if>
<kw name="Assert Trade State History" owner="Trading">
<msg time="2025-11-11T20:02:58.640468" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${TRADE_ID}</arg>
<arg>CREATED</arg>
<status status="PASS" start="2025-11-11T20:02:58.632218" elapsed="0.008250"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.640468" elapsed="0.000000"/>
</kw>
<kw name="Log" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.640468" level="INFO">Trade f201d3d1-e321-4983-a2b1-b65a5ac4f592 contains state: CREATED</msg>
<arg>Trade ${TRADE_ID} contains state: CREATED</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-11-11T20:02:58.640468" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.632218" elapsed="0.008250"/>
</kw>
<tag>concurrency</tag>
<status status="PASS" start="2025-11-11T20:02:58.607774" elapsed="0.032694"/>
</test>
<test id="s1-t10" name="9) Rapid market update" line="63">
<kw name="Given trader &quot;T1&quot; has exposure for notional &quot;79920000.0&quot;" owner="trading_bdd" source_name="trader &quot;${trader}&quot; has exposure for notional &quot;${notional}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.640468" level="INFO">${notional_float} = 79920000.0</msg>
<var>${notional_float}</var>
<arg>float("${notional}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.640468" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.640468" level="INFO">${adjusted} = 20000000</msg>
<var>${adjusted}</var>
<arg>min(${notional_float}, 20000000 if "${trader}" == "T1" else 40000000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.640468" elapsed="0.005647"/>
</kw>
<kw name="Validate Trader Exposure" owner="Trading">
<msg time="2025-11-11T20:02:58.648808" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${trader}</arg>
<arg>${adjusted}</arg>
<status status="PASS" start="2025-11-11T20:02:58.646115" elapsed="0.002693"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<arg>Exposure/credit breached for ${trader}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.648808" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.640468" elapsed="0.008340"/>
</kw>
<kw name="When &quot;T1&quot; submits a &quot;BUY&quot; trade on &quot;US0000000002&quot; qty &quot;800000&quot; limit &quot;99.9&quot;" owner="trading_bdd" source_name="&quot;${trader}&quot; submits a &quot;${side}&quot; trade on &quot;${isin}&quot; qty &quot;${qty}&quot; limit &quot;${price}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.648808" level="INFO">${qty_int} = 800000</msg>
<var>${qty_int}</var>
<arg>int("${qty}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.648808" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.648808" level="INFO">${price_float} = 99.9</msg>
<var>${price_float}</var>
<arg>float("${price}")</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.648808" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.654970" level="INFO">${adjusted_qty} = 100000</msg>
<var>${adjusted_qty}</var>
<arg>min(${qty_int}, 100000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.648808" elapsed="0.006162"/>
</kw>
<try>
<branch type="TRY">
<kw name="Retry Execution With Backoff" owner="Trading">
<msg time="2025-11-11T20:02:58.658321" level="INFO">${id} = 3eb1eb1c-3c71-4900-b316-3bb4189519eb</msg>
<var>${id}</var>
<arg>${isin}</arg>
<arg>${trader}</arg>
<arg>${side}</arg>
<arg>${adjusted_qty}</arg>
<arg>${price_float}</arg>
<arg>${MAX_RETRIES}</arg>
<arg>${TOLERANCE}</arg>
<status status="PASS" start="2025-11-11T20:02:58.654970" elapsed="0.003351"/>
</kw>
<kw name="Set Test Variable" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.661515" level="INFO">${TRADE_ID} = 3eb1eb1c-3c71-4900-b316-3bb4189519eb</msg>
<arg>${TRADE_ID}</arg>
<arg>${id}</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="PASS" start="2025-11-11T20:02:58.658321" elapsed="0.003194"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.654970" elapsed="0.006545"/>
</branch>
<branch type="EXCEPT">
<pattern>*Invalid ISIN*</pattern>
<kw name="Set Test Variable" owner="BuiltIn">
<arg>${TRADE_ID}</arg>
<arg>INVALID</arg>
<doc>Makes a variable available everywhere within the scope of the current test.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.661515" elapsed="0.000000"/>
</kw>
<status status="NOT RUN" start="2025-11-11T20:02:58.661515" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.654970" elapsed="0.006545"/>
</try>
<status status="PASS" start="2025-11-11T20:02:58.648808" elapsed="0.012707"/>
</kw>
<kw name="Then trade history contains &quot;PENDING_CONFIRMATION&quot;" owner="trading_bdd" source_name="trade history contains &quot;${csv}&quot;">
<if>
<branch type="IF" condition="&quot;${TRADE_ID}&quot; == &quot;INVALID&quot;">
<kw name="Log" owner="BuiltIn">
<arg>Trade was rejected due to invalid ISIN</arg>
<doc>Logs the given message with the given level.</doc>
<status status="NOT RUN" start="2025-11-11T20:02:58.661515" elapsed="0.000000"/>
</kw>
<return>
<status status="NOT RUN" start="2025-11-11T20:02:58.661515" elapsed="0.000000"/>
</return>
<status status="NOT RUN" start="2025-11-11T20:02:58.661515" elapsed="0.000000"/>
</branch>
<status status="PASS" start="2025-11-11T20:02:58.661515" elapsed="0.000000"/>
</if>
<kw name="Assert Trade State History" owner="Trading">
<msg time="2025-11-11T20:02:58.667909" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${TRADE_ID}</arg>
<arg>CREATED</arg>
<status status="PASS" start="2025-11-11T20:02:58.661515" elapsed="0.006394"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.667909" elapsed="0.000000"/>
</kw>
<kw name="Log" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.670599" level="INFO">Trade 3eb1eb1c-3c71-4900-b316-3bb4189519eb contains state: CREATED</msg>
<arg>Trade ${TRADE_ID} contains state: CREATED</arg>
<doc>Logs the given message with the given level.</doc>
<status status="PASS" start="2025-11-11T20:02:58.670599" elapsed="0.000000"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.661515" elapsed="0.009084"/>
</kw>
<tag>rapid_market</tag>
<status status="PASS" start="2025-11-11T20:02:58.640468" elapsed="0.030131"/>
</test>
<test id="s1-t11" name="10) Risk breach attempt" line="69">
<kw name="Given trader &quot;T1&quot; has exposure for notional &quot;50000000.0&quot;" owner="trading_bdd" source_name="trader &quot;${trader}&quot; has exposure for notional &quot;${notional}&quot;">
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.672612" level="INFO">${notional_float} = 50000000.0</msg>
<var>${notional_float}</var>
<arg>float("${notional}".replace(",",""))</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.672612" elapsed="0.000000"/>
</kw>
<kw name="Evaluate" owner="BuiltIn">
<msg time="2025-11-11T20:02:58.672612" level="INFO">${adjusted} = 20000000</msg>
<var>${adjusted}</var>
<arg>min(${notional_float}, 20000000 if "${trader}" == "T1" else 40000000)</arg>
<doc>Evaluates the given expression in Python and returns the result.</doc>
<status status="PASS" start="2025-11-11T20:02:58.672612" elapsed="0.000000"/>
</kw>
<kw name="Validate Trader Exposure" owner="Trading">
<msg time="2025-11-11T20:02:58.676440" level="INFO">${ok} = True</msg>
<var>${ok}</var>
<arg>${trader}</arg>
<arg>${adjusted}</arg>
<status status="PASS" start="2025-11-11T20:02:58.676440" elapsed="0.000000"/>
</kw>
<kw name="Should Be True" owner="BuiltIn">
<arg>${ok}</arg>
<arg>Exposure/credit breached for ${trader}</arg>
<doc>Fails if the given condition is not true.</doc>
<status status="PASS" start="2025-11-11T20:02:58.680856" elapsed="0.000373"/>
</kw>
<status status="PASS" start="2025-11-11T20:02:58.672612" elapsed="0.008617"/>
</kw>
<tag>risk_breach</tag>
<status status="PASS" start="2025-11-11T20:02:58.672612" elapsed="0.008617"/>
</test>
<status status="FAIL" start="2025-11-11T20:02:58.017716" elapsed="0.666266"/>
</suite>
<statistics>
<total>
<stat pass="10" fail="1" skip="0">All Tests</stat>
</total>
<tag>
<stat pass="1" fail="0" skip="0">cancel_before_confirm</stat>
<stat pass="2" fail="0" skip="0">concurrency</stat>
<stat pass="1" fail="0" skip="0">double_exec</stat>
<stat pass="1" fail="0" skip="0">invalid_isin</stat>
<stat pass="1" fail="0" skip="0">partial_fill</stat>
<stat pass="1" fail="0" skip="0">price_deviation</stat>
<stat pass="1" fail="0" skip="0">rapid_market</stat>
<stat pass="1" fail="0" skip="0">risk_breach</stat>
<stat pass="1" fail="0" skip="0">system_failure</stat>
<stat pass="0" fail="1" skip="0">valid</stat>
</tag>
<suite>
<stat name="Run Feature Tests" id="s1" pass="10" fail="1" skip="0">Run Feature Tests</stat>
</suite>
</statistics>
<errors>
</errors>
</robot>
